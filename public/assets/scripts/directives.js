!function(){"use strict";function e(e,t){return{require:"ngModel",scope:{ngModel:"=",slug:"=",postId:"="},link:function(s,a,n,r){a.on("blur",function(){var a=r.$modelValue;a&&0!=a.length&&t.checkSlug(a,s.postId).success(function(t){t.slug&&e(function(){s.slug=t.slug})}).error(function(e){})})}}}function t(e){return{restrict:"E",templateUrl:"/assets/templates/editor/tags.html",scope:{postTags:"=tags"},link:function(t,s,a){t.inputtedTag="",t.journalTags=[],t.suggestedTags=[],t.tags=[],t.showSuggestions=!1,t.addTag=function(e){t.addToPostTag(e)},t.addToPostTag=function(e){for(var s in t.postTags)if(t.postTags[s].name==e)return;t.showSuggestions=!1,t.postTags.push({name:e}),t.inputtedTag="",t.setupSuggestionTags()},t.initialize=function(){e.getTags().success(function(e){e.tags&&(t.journalTags=e.tags,t.setupSuggestionTags())})},t.inputYourTag=function(e){t.showSuggestions=!0,console.log(t.suggestedTags.length),13==e.which&&(e.preventDefault(),t.inputtedTag.length>0&&t.addToPostTag(t.inputtedTag)),t.inputtedTag.length<0&&(t.showSuggestions=!1)},t.setupSuggestionTags=function(){if(t.suggestedTags=t.journalTags,t.postTags)for(var e in t.postTags)for(var s in t.suggestedTags)t.postTags[e].name==t.suggestedTags[s].name&&t.suggestedTags.splice(s,1)},t.removePostTag=function(e){var s=t.postTags.indexOf(e);t.postTags.splice(s,1),t.suggestedTags.push(e)},t.initialize()}}}function s(){return{link:function(){angular.element(document.getElementsByClassName("CodeMirror-scroll")[0]).on("scroll",function(e){var t=angular.element(e.target),s=angular.element(document.getElementsByClassName("entry-preview-content")),a=angular.element(document.getElementsByClassName("CodeMirror-sizer")),n=angular.element(document.getElementsByClassName("rendered-markdown")),r=a[0].offsetHeight-t[0].offsetHeight,i=n[0].offsetHeight-s[0].offsetHeight,o=i/r,g=t[0].scrollTop*o;s[0].scrollTop=g})}}}angular.module("journal.component.editor").directive("checkPostSlug",["$timeout","EditorService",e]).directive("tagInput",["EditorService",t]).directive("editorScroll",[s])}(),function(){"use strict";function e(e,t){return{restrict:"AE",scope:{journalMarkdown:"=",counter:"="},link:function(e,s,a){var n=function(){var t=0,a=s.text().replace(/^\s\s*/,"").replace(/\s\s*$/,"");a.length>0&&(t=a.match(/[^\s]+/g).length),e.counter=t};if(a.journalMarkdown)e.$watch("journalMarkdown",function(e){var r=e?t.makeHtml(e):"";a.hideScriptIframe&&(r=r.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,'<div class="embedded-javascript">Embedded JavaScript</div>'),r=r.replace(/<iframe\b[^<]*(?:(?!<\/iframe>)<[^<]*)*<\/iframe>/gi,'<div class="embedded-iframe">Embedded iFrame</div>')),s.html(r),n()});else{var r=t.makeHtml(s.text());a.hideScriptIframe&&(r=r.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,'<div class="embedded-javascript">Embedded JavaScript</div>'),r=r.replace(/<iframe\b[^<]*(?:(?!<\/iframe>)<[^<]*)*<\/iframe>/gi,'<div class="embedded-iframe">Embedded iFrame</div>')),s.html(r),n()}}}}angular.module("journal.shared.markdownConverter").directive("journalMarkdown",["$sanitize","MarkdownConverter",e])}();