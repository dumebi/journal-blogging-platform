!function(){"use strict";angular.module("Journal",["journal.config","journal.constants","journal.routes","journal.run","journal.components.login","journal.components.post","journal.components.postLists","journal.components.sidebar","journal.shared.auth","journal.shared.markdownReader","journal.shared.storage","journal.shared.toastr"]),angular.module("journal.config",["LocalStorageModule","toastr"]),angular.module("journal.constants",[]),angular.module("journal.routes",["ui.router","journal.constants"]),angular.module("journal.run",[]),angular.module("journal.components.login",[]),angular.module("journal.components.post",[]),angular.module("journal.components.postLists",[]),angular.module("journal.components.sidebar",[]),angular.module("journal.shared.auth",[]),angular.module("journal.shared.markdownReader",[]),angular.module("journal.shared.storage",["LocalStorageModule"]),angular.module("journal.shared.toastr",["ngAnimate","toastr"])}(),function(){"use strict";function e(e){angular.extend(e,{autoDismiss:!1,containerId:"toast-container",maxOpened:5,newestOnTop:!1,positionClass:"toast-bottom-left",preventDuplicates:!1,preventOpenDuplicates:!0,target:"body",timeOut:1e4})}function t(e){e.defaults.useXDomain=!0,delete e.defaults.headers.common["X-Requested-With"]}function r(e){e.setPrefix("journal")}angular.module("journal.config").config(["$httpProvider",t]).config(["toastrConfig",e]).config(["localStorageServiceProvider",r])}(),function(){"use strict";function e(e,t){var r=function(e){return"/assets/templates/"+e};t.otherwise("/"),e.state("login",{url:"/login",templateUrl:r("login/login.html")}).state("post",{"abstract":!0,url:"/post",views:{"":{templateUrl:r("post/post.html")},sidebar:{templateUrl:r("sidebar/sidebar.html")}}}).state("post.lists",{url:"/lists",views:{post_content:{templateUrl:r("post-lists/post-lists.html")}}})}angular.module("journal.routes").config(["$stateProvider","$urlRouterProvider",e])}(),function(){"use strict";angular.module("journal.run")}(),function(){"use strict";angular.module("journal.constants").constant("CONFIG",{API_URL:"http://localhost:8000/api/v1.0",DEFAULT_AVATAR_URL:"http://40.media.tumblr.com/7d65a925636d6e3df94e2ebe30667c29/tumblr_nq1zg0MEn51qg6rkio1_500.jpg",DEFAULT_COVER_URL:"/assets/images/wallpaper.jpg",VERSION:"2.0.0",CDN_URL:"http://localhost:8000"})}(),function(){"use strict";function e(e,t,r,n){var o=this;o.login={},o.processing=!1,o.authenticateLogin=function(){var a=o.login;o.processing=!1,r.authenticate(a.email,a.password).then(function(r){return r.user&&r.token?(t.login(r.user,r.token),void e.go("post.lists")):void 0},function(e){var t=e.errors.message;return t?void n.toast(t,"error"):void 0})}}angular.module("journal.components.login").controller("LoginController",["$state","AuthService","LoginService","ToastrService",e])}(),function(){"use strict";function e(e){var t=this;t.active=[],t.posts={},t.processing=!0,t.initialize=function(){e.getAllPosts().then(function(e){e.posts&&(t.posts=e.posts,t.active=t.posts[0]),t.processing=!1},function(){})},t.selectThisPost=function(e){t.active=e},t.initialize()}angular.module("journal.components.postLists").controller("PostListsController",["PostListsService",e])}(),function(){"use strict";function e(){return{restrict:"E",templateUrl:"/assets/templates/sidebar/sidebar-directive.html",replace:!0,link:function(e,t,r){}}}angular.module("journal.components.sidebar").directive("journalSidebar",[e])}(),function(){"use strict";function e(e){return{restrict:"AE",scope:{journalMarkdown:"=",counter:"="},link:function(t,r,n){var o=function(){var e=0,n=r.text().replace(/^\s\s*/,"").replace(/\s\s*$/,"");n.length>0&&(e=n.match(/[^\s]+/g).length),t.counter=e};if(n.journalMarkdown)t.$watch("journalMarkdown",function(t){var a=t?e.makeHtml(t):"";n.hideScriptIframe&&(a=a.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,'<div class="embedded-javascript">Embedded JavaScript</div>'),a=a.replace(/<iframe\b[^<]*(?:(?!<\/iframe>)<[^<]*)*<\/iframe>/gi,'<div class="embedded-iframe">Embedded iFrame</div>')),r.html(a),o()});else{var a=e.makeHtml(r.text());n.hideScriptIframe&&(a=a.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,'<div class="embedded-javascript">Embedded JavaScript</div>'),a=a.replace(/<iframe\b[^<]*(?:(?!<\/iframe>)<[^<]*)*<\/iframe>/gi,'<div class="embedded-iframe">Embedded iFrame</div>')),r.html(a),o()}}}}angular.module("journal.shared.markdownReader").directive("journalMarkdown",["MarkdownReader",e])}(),function(){"use strict";function e(){var e={};return{config:function(t){e=t},$get:function(){return new showdown.Converter(e)}}}angular.module("journal.shared.markdownReader").provider("MarkdownReader",[e])}(),function(){"use strict";function e(e,t,r){this.apiUrl=r.API_URL,this.authenticate=function(r,n){var o=t.defer(),a={email:r,password:n};return e.post(this.apiUrl+"/auth/authenticate",a).success(function(e){o.resolve(e)}).error(function(e){o.reject(e)}),o.promise}}angular.module("journal.components.login").service("LoginService",["$http","$q","CONFIG",e])}(),function(){"use strict";function e(e,t,r){this.apiUrl=r.API_URL,this.getAllPosts=function(){var r=t.defer();return e.get(this.apiUrl+"/posts/all").success(function(e){r.resolve(e)}).error(function(e){r.reject(e)}),r.promise}}angular.module("journal.components.postLists").service("PostListsService",["$http","$q","CONFIG",e])}(),function(){"use strict";function e(e){this.login=function(t,r){e.set("user",t),e.set("token",r)},this.logout=function(){e.remove("user"),e.remove("token")},this.token=function(){return e.get("user")},this.user=function(){return e.get("user")}}angular.module("journal.shared.auth").service("AuthService",["StorageService",e])}(),function(){"use strict";function e(e){this.set=function(t,r){return e.set(t,r)},this.get=function(t){return e.get(t)},this.remove=function(t){return e.remove(t)}}angular.module("journal.shared.storage").service("StorageService",["localStorageService",e])}(),function(){"use strict";function e(e){this.toast=function(t,r){switch(r){case"success":e.success(t);break;case"info":e.info(t);break;case"error":e.error(t);break;case"warning":e.warning("message");break;default:e.success(t)}}}angular.module("journal.shared.toastr").service("ToastrService",["toastr",e])}();