!function(){"use strict";angular.module("Journal",["journal.config","journal.constants","journal.routes","journal.run","journal.components.editor","journal.components.login","journal.components.postLists","journal.components.settingsGeneral","journal.components.settingsGeneralModal","journal.components.sidebar","journal.components.userCreate","journal.components.userLists","journal.components.userProfile","journal.components.userProfileModal","journal.shared.auth","journal.shared.fileUploader","journal.shared.markdownReader","journal.shared.storage","journal.shared.toastr","angular-ladda"]),angular.module("journal.config",["LocalStorageModule","toastr"]),angular.module("journal.constants",[]),angular.module("journal.routes",["ui.router","journal.constants"]),angular.module("journal.run",["ngProgressLite"]),angular.module("journal.components.editor",["ngFileUpload","ui.bootstrap","ui.codemirror"]),angular.module("journal.components.login",[]),angular.module("journal.components.post",[]),angular.module("journal.components.postLists",[]),angular.module("journal.components.settings",[]),angular.module("journal.components.settingsGeneral",[]),angular.module("journal.components.settingsGeneralModal",[]),angular.module("journal.components.sidebar",[]),angular.module("journal.components.user",[]),angular.module("journal.components.userCreate",[]),angular.module("journal.components.userLists",["angularMoment"]),angular.module("journal.components.userProfile",[]),angular.module("journal.components.userProfileModal",[]),angular.module("journal.shared.auth",[]),angular.module("journal.shared.fileUploader",["ngFileUpload"]),angular.module("journal.shared.markdownReader",[]),angular.module("journal.shared.storage",["LocalStorageModule"]),angular.module("journal.shared.toastr",["ngAnimate","toastr"])}(),function(){"use strict";function e(e){angular.extend(e,{autoDismiss:!1,containerId:"toast-container",maxOpened:5,newestOnTop:!1,positionClass:"toast-bottom-left",preventDuplicates:!1,preventOpenDuplicates:!0,target:"body",timeOut:1e4})}function t(e){e.defaults.useXDomain=!0,delete e.defaults.headers.common["X-Requested-With"]}function r(e){e.setPrefix("journal")}angular.module("journal.config").config(["$httpProvider",t]).config(["toastrConfig",e]).config(["localStorageServiceProvider",r])}(),function(){"use strict";function e(e,t,r){var o=function(e){return r.TEMPLATE_PATH+e};t.otherwise("/").when("/","/post/lists").when("/post","/post/lists"),e.state("editor",{url:"/editor",views:{"":{templateUrl:o("editor/editor.html")},sidebar:{templateUrl:o("sidebar/sidebar.html")}},authenticate:!0}).state("editorPost",{url:"/editor/:postId",views:{"":{templateUrl:o("editor/editor.html")},sidebar:{templateUrl:o("sidebar/sidebar.html")}},authenticate:!0}).state("login",{url:"/login",templateUrl:o("login/login.html"),authenticate:!1}).state("post",{"abstract":!0,url:"/post",views:{"":{templateUrl:o("post/post.html")},sidebar:{templateUrl:o("sidebar/sidebar.html")}},authenticate:!0}).state("post.lists",{url:"/lists",views:{post_content:{templateUrl:o("post-lists/post-lists.html")}},authenticate:!0}).state("settings",{url:"/settings",views:{"":{templateUrl:o("settings/settings.html")},sidebar:{templateUrl:o("sidebar/sidebar.html")}},"abstract":!0,authenticate:!0}).state("settings.general",{url:"/general",views:{settings_content:{templateUrl:o("settings-general/settings-general.html")}}}).state("user",{url:"/user",views:{"":{templateUrl:o("user/user.html")},sidebar:{templateUrl:o("sidebar/sidebar.html")}},"abstract":!0,authenticate:!0}).state("user.create",{url:"/create",views:{user_content:{templateUrl:o("user-create/user-create.html")}},authenticate:!0}).state("user.lists",{url:"/lists",views:{user_content:{templateUrl:o("user-lists/user-lists.html")}},authenticate:!0}).state("user.profile",{url:"/profile/:userId",views:{user_content:{templateUrl:o("user-profile/user-profile.html")}}})}angular.module("journal.routes").config(["$stateProvider","$urlRouterProvider","CONFIG",e])}(),function(){"use strict";function e(e,t,r){var o=r;o.token()&&o.validateToken().then(function(n){if(n.user){e.bootFinish=!0,r.login(n.user,o.token());var s=e.nextPage;delete e.nextPage,t.transitionTo(s.name,s.params)}},function(){e.bootFinish=!0,o.logout(),t.transitionTo("login")}),o.token()||(e.bootFinish=!0,o.logout(),t.transitionTo("login"))}function t(e,t,r,o,n){e.$on("$stateChangeStart",function(r,s,i,a,u){return e.bootFinish?(n.start(),e.loggedIn=!0,s.authenticate&&!o.user()&&(t.transitionTo("login"),e.loggedIn=!1,r.preventDefault(),n.done()),void("login"==s.name&&(e.loggedIn=!1,o.user()&&(e.loggedIn=!0,t.transitionTo("post.lists"),r.preventDefault())))):(e.nextPage=s,e.nextPage.params=i,n.done(),void r.preventDefault())}),e.$on("$stateChangeSuccess",function(e,t,o,s,i){r(function(){n.done()})})}angular.module("journal.run").run(["$rootScope","$state","AuthService",e]).run(["$rootScope","$state","$timeout","AuthService","ngProgressLite",t])}(),function(){"use strict";angular.module("journal.constants").constant("CONFIG",{API_URL:"http://localhost:8000/api/v1.0",DEFAULT_AVATAR_URL:"http://40.media.tumblr.com/7d65a925636d6e3df94e2ebe30667c29/tumblr_nq1zg0MEn51qg6rkio1_500.jpg",DEFAULT_COVER_URL:"/assets/images/wallpaper.jpg",VERSION:"2.0.0",CDN_URL:"http://localhost:8000",TEMPLATE_PATH:"/assets/templates/"})}(),function(){"use strict";function e(e,t,r,o,n){var s=this;s.options={codemirror:{mode:"markdown",tabMode:"indent",lineWrapping:!0},counter:0,toggle:!1},s.post={status:2,tags:[]},s.processing=!1,s.convertTimestamp=function(e){if(e){var t=new Date(1e3*e);return new Date(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes())}var r=new Date,o=new Date(r.getFullYear(),r.getMonth(),r.getDate(),r.getHours(),r.getMinutes());return o},s.initialize=function(){s.post.published_at=s.convertTimestamp(),e.postId&&r.getPost(e.postId).then(function(e){e.post&&(e.post.published_at=s.convertTimestamp(e.post.published_at),s.post=e.post)},function(e){})},s.openMarkdownHelper=function(){t.open({animation:!0,controllerAs:"mdh",controller:["$uibModalInstance",function(e){var t=this;t.closeModal=function(){e.dismiss("cancel")}}],size:"markdown",templateUrl:n.TEMPLATE_PATH+"editor/_markdown-helper.html"})},s.savePost=function(){var e=s.post;s.processing=!0,r.savePost(e).then(function(e){if(e.post){var t=e.post;s.post.id?o.toast('You have successfully updated "'+t.title+'".',"success"):o.toast('You have successfully created the post"'+t.title+'"',"success"),t.published_at=s.convertTimestamp(t.published_at),s.post=t}s.processing=!1},function(e){s.processing=!1})},s.toggleSidebar=function(){s.options.toggle=!s.options.toggle},s.initialize()}angular.module("journal.components.editor").controller("EditorController",["$stateParams","$uibModal","EditorService","ToastrService","CONFIG",e])}(),function(){"use strict";function e(e,t,r,o){var n=this;n.login={},n.processing=!1,n.authenticateLogin=function(){var s=n.login;n.processing=!0,r.authenticate(s.email,s.password).then(function(r){return r.user&&r.token?(o.toast("Welcome back, "+r.user.name),t.login(r.user,r.token),void e.go("post.lists")):void(n.processing=!1)},function(e){n.processing=!1;var t=e.errors.message;return t?void o.toast(t,"error"):void 0})}}angular.module("journal.components.login").controller("LoginController",["$state","AuthService","LoginService","ToastrService",e])}(),function(){"use strict";function e(e){var t=this;t.active=[],t.posts={},t.processing=!0,t.initialize=function(){e.getAllPosts().then(function(e){e.posts&&(t.posts=e.posts,t.active=t.posts[0]),t.processing=!1},function(){})},t.selectThisPost=function(e){t.active=e},t.initialize()}angular.module("journal.components.postLists").controller("PostListsController",["PostListsService",e])}(),function(){"use strict";function e(e,t,r,o){var n=this;n.loading=!0,n.processing=!1,n.settings={},n.themes={},n.initialize=function(){var e="title,description,post_per_page,logo_url,cover_url,theme";t.getSettings(e).then(function(e){e.settings&&(n.settings=e.settings,n.settings.post_per_page&&(n.settings.post_per_page=parseInt(n.settings.post_per_page)))},function(e){n.loading=!1}),t.themes().then(function(e){e.themes&&(n.themes=e.themes),n.loading=!1})},n.openUploaderModal=function(t){var r=e.open({animation:!0,controllerAs:"um",controller:"SettingsGeneralModalController",templateUrl:o.TEMPLATE_PATH+"uploader-modal/uploader-modal.html",resolve:{settings:function(){return angular.copy(n.settings)},type:function(){return t}}});r.result.then(function(e){n.settings=e,n.settings.post_per_page&&(n.settings.post_per_page=parseInt(n.settings.post_per_page))})},n.saveSettings=function(){var e=n.settings;n.processing=!0,t.saveSettings(e).then(function(t){t.settings&&(n.settings=e,n.settings.post_per_page&&(n.settings.post_per_page=parseInt(n.settings.post_per_page)),r.toast("You have successfully updated your blog settings.","success")),n.processing=!1},function(){n.processing=!1,r.toast("Something went wrong while processing your request. Please try again later.","error")})},n.initialize()}angular.module("journal.components.settingsGeneral").controller("SettingsGeneralController",["$uibModal","SettingsGeneralService","ToastrService","CONFIG",e])}(),function(){"use strict";function e(e,t,r,o,n,s,i,a){var u=this;u.settings=i,u.image={link:null,file:null,option:"file",url:""},u.processing=!1,u.type=a,u.upload={active:!1,percentage:0},u.closeModal=function(){r.dismiss("cancel")},u.getImageLink=function(){t(function(){u.image.url=u.image.link,u.image.link=null,u.updatePhotoDetails(u.image.url)},1e3)},u.initialize=function(){switch(u.type){case"cover":u.image.url=u.settings.cover_url||"";break;case"logo":u.image.url=u.settings.logo_url||""}},u.removeImage=function(){u.image.url="",u.updatePhotoDetails(u.image.url)},u.save=function(){var e=u.settings;u.processing=!0,s.saveSettings(e).then(function(e){e.settings&&(n.toast("You have successfully updated your "+u.type+" photo."),r.close(e.settings)),u.processing=!1},function(){n.toast("Something went wrong while uploading the photo to the server.","error"),u.processing=!1})},u.switchOption=function(){return"file"==u.image.option?void(u.image.option="link"):"link"==u.image.option?void(u.image.option="file"):void 0},u.updatePhotoDetails=function(e){switch(u.type){case"cover":u.settings.cover_url=e;break;case"logo":u.settings.logo_url=e}},e.$watch(function(){return u.image.file},function(e){e&&(u.processing=!0,o.upload(e).progress(function(e){u.upload={active:!0,percentage:parseInt(100*e.loaded/e.total)}}).success(function(e){e.url&&(u.image.url=e.url,u.updatePhotoDetails(e.url),u.upload={active:!1,percentage:0}),u.processing=!1}).error(function(){n.toast("Something went wrong with the upload. Please try again later.","error"),u.upload={active:!1,percentage:0},u.processing=!1}))}),u.initialize()}angular.module("journal.components.settingsGeneralModal").controller("SettingsGeneralModalController",["$scope","$timeout","$uibModalInstance","FileUploaderService","ToastrService","SettingsGeneralModalService","settings","type",e])}(),function(){"use strict";function e(e,t){var r=this;r.errors={},r.processing=!1,r.roles={},r.user={},r.initialize=function(){t.getRoles().then(function(e){e.roles&&(r.roles=e.roles)},function(e){})},r.createUser=function(){var o=r.user;r.processing=!0,t.createUser(o).then(function(e){e.user&&(r.user={})},function(t){t.errors&&(e.toast("Oops, there some errors encountered.","error"),r.errors=t.errors)})},r.initialize()}angular.module("journal.components.userCreate").controller("UserCreateController",["ToastrService","UserCreateService",e])}(),function(){"use strict";function e(e,t){var r=this;r.processing=!1,r.users=[],r.initialize=function(){e.getUsers().then(function(e){e.users&&(r.users=e.users),r.processing=!1},function(e){})},r.setUserAvatar=function(e){return e.avatar_url?e.avatar_url:t.DEFAULT_AVATAR_URL},r.initialize()}angular.module("journal.components.userLists").controller("UserListsController",["UserListsService","CONFIG",e])}(),function(){"use strict";function e(e,t,r,o,n,s,i){var a=this;a.current=!1,a.errors={},a.loading=!0,a.loggedInUser=o.user(),a.processing=!1,a.user={},a.initialize=function(){t.userId?s.getUser(t.userId).then(function(e){if(e.user){var t=e.user;a.user=t,a.current=a.loggedInUser.id==t.id,a.loading=!1}},function(e){}):e.transitionTo("user.lists")},a.openPhotoUploader=function(e){var t=r.open({animation:!0,controllerAs:"um",controller:"UserProfileModalController",templateUrl:i.TEMPLATE_PATH+"uploader-modal/uploader-modal.html",resolve:{user:function(){return angular.copy(a.user)},type:function(){return e}}});t.result.then(function(e){a.user=e})},a.setPhoto=function(e){var t;if(!a.loading){switch(e){case"avatar":t=a.user.avatar_url?a.user.avatar_url:i.DEFAULT_AVATAR_URL;break;case"cover":t=a.user.cover_url?a.user.cover_url:i.DEFAULT_COVER_URL}return t}},a.updateProfile=function(){var e=a.user;a.processing=!0,s.updateProfileDetails(e).then(function(e){e.user&&(n.toast("You have successfully updated your profile.","success"),a.user=e.user),a.processing=!1},function(e){e.errors&&(n.toast("There are some errors encountered.","error"),a.errors=e.errors),a.processing=!1})},a.initialize()}angular.module("journal.components.userProfile").controller("UserProfileController",["$state","$stateParams","$uibModal","AuthService","ToastrService","UserProfileService","CONFIG",e])}(),function(){"use strict";function e(e,t,r,o,n,s,i,a){var u=this;u.currentUser=i,u.image={link:null,file:null,option:"file",url:""},u.processing=!1,u.type=a,u.upload={active:!1,percentage:0},u.closeModal=function(){r.dismiss("cancel")},u.getImageLink=function(){t(function(){u.image.url=u.image.link,u.image.link=null,u.updateUserPhotoDetails(u.image.url)},1e3)},u.initialize=function(){switch(u.type){case"avatar":u.image.url=u.currentUser.avatar_url||"";break;case"cover":u.image.url=u.currentUser.cover_url||""}},u.removeImage=function(){u.image.url="",u.updateUserPhotoDetails(u.image.url)},u.save=function(){var e=u.currentUser;u.processing=!0,s.updateUserDetails(e).then(function(e){e.user&&(n.toast("You have successfully updated your "+u.type+" photo."),r.close(e.user)),u.processing=!1},function(){n.toast("Something went wrong while uploading the photo to the server.","error"),u.processing=!1})},u.switchOption=function(){return"file"==u.image.option?void(u.image.option="link"):"link"==u.image.option?void(u.image.option="file"):void 0},u.updateUserPhotoDetails=function(e){switch(u.type){case"avatar":u.currentUser.avatar_url=e;break;case"cover":u.currentUser.cover_url=e}},e.$watch(function(){return u.image.file},function(e){e&&(u.processing=!0,o.upload(e).progress(function(e){u.upload={active:!0,percentage:parseInt(100*e.loaded/e.total)}}).success(function(e){e.url&&(u.image.url=e.url,u.updateUserPhotoDetails(e.url),u.upload={active:!1,percentage:0}),u.processing=!1}).error(function(){n.toast("Something went wrong with the upload. Please try again later.","error"),u.upload={active:!1,percentage:0},u.processing=!1}))}),u.initialize()}angular.module("journal.components.userProfileModal").controller("UserProfileModalController",["$scope","$timeout","$uibModalInstance","FileUploaderService","ToastrService","UserProfileModalService","user","type",e])}(),function(){"use strict";function e(){return{restrict:"C",link:function(){angular.element(document.getElementsByClassName("CodeMirror-scroll")[0]).on("scroll",function(e){var t=angular.element(e.target),r=angular.element(document.getElementsByClassName("preview-wrapper")),o=angular.element(document.getElementsByClassName("CodeMirror-sizer")),n=angular.element(document.getElementsByClassName("rendered-markdown")),s=o[0].offsetHeight-t[0].offsetHeight,i=n[0].offsetHeight-r[0].offsetHeight,a=i/s,u=t[0].scrollTop*a;r[0].scrollTop=u})}}}function t(e){return{require:"ngModel",restrict:"EA",replace:!0,scope:{ngModel:"=ngModel",post:"=post",processing:"=processing"},templateUrl:e.TEMPLATE_PATH+"editor/_editor-publish-buttons.html",controllerAs:"epb",controller:["$scope",function(e){var t=this;t.options={status:2,active:[],buttons:[{"class":"btn-danger",group:1,status:1,text:"Publish Now"},{"class":"btn-primary",group:1,status:2,text:"Save as Draft"},{"class":"btn-danger",group:2,status:2,text:"Unpublish Post"},{"class":"btn-info",group:2,status:1,text:"Update Post"}]},t.processing=!1,t.selectPostStatus=function(r){t.options.active=r,t.options.status=t.options.active.status,e.ngModel=t.options.status},t.setButtons=function(e){var r=t.options.buttons[3];2==e&&(r=t.options.buttons[1]),t.options.active=r}}],link:function(e,t,r){e.$watch("post",function(t){e.epb.setButtons(t.status)}),e.$watch("processing",function(t){e.epb.processing=t})}}}function r(){return{require:"ngModel",restrict:"C",scope:{title:"=ngModel",postId:"=postId",slug:"=slug"},controllerAs:"ips",controller:["$scope","EditorService",function(e,t){var r=this;r.checkPostTitle=function(r,o){t.getSlug(r,o).then(function(t){t.slug&&(e.slug=t.slug)},function(e){})}}],link:function(e,t,r,o){t.on("blur",function(){var t=o.$modelValue;t&&0!=t.length&&e.ips.checkPostTitle(t,e.postId)})}}}function o(e){return{restrict:"EA",scope:{toggle:"=toggle",postData:"=post"},replace:!0,templateUrl:e.TEMPLATE_PATH+"editor/_editor-sidebar.html",controllerAs:"es",controller:["$scope",function(e){var t=this;t.toggle=!1,t.post=[],t.siteUrl=window.location.origin,t.closeSidebar=function(){t.toggle=!1,e.toggle=!1},e.$watchCollection(function(){return t.post},function(t){e.post=t})}],link:function(e,t,r){e.$watch("postData",function(t){e.es.post=t}),e.$watch("toggle",function(t){e.es.toggle=t})}}}function n(e){return{restrict:"EA",require:"ngModel",scope:{featuredImage:"=ngModel"},replace:!0,templateUrl:e.TEMPLATE_PATH+"editor/_featured-image.html",controllerAs:"fi",controller:["$scope","$timeout","FileUploaderService","ToastrService",function(e,t,r,o){var n=this;n.image={link:null,file:null,option:"file",url:""},n.processing=!1,n.upload={active:!1,percentage:0},n.getImageLink=function(){t(function(){n.image.url=n.image.link,e.featuredImage=n.image.url,n.image.link=null},1e3)},n.removeImage=function(){n.image.url=""},n.switchOption=function(){return"file"==n.image.option?void(n.image.option="link"):"link"==n.image.option?void(n.image.option="file"):void 0},e.$watch(function(){return n.image.file},function(t){t&&r.upload(t).progress(function(e){n.upload={active:!0,percentage:parseInt(100*e.loaded/e.total)}}).success(function(t){t.url&&(n.image.url=t.url,e.featuredImage=n.image.url,n.upload={active:!1,percentage:0})}).error(function(){o.toast("Something went wrong with the upload. Please try again later.","error"),n.upload={active:!1,percentage:0}})})}],link:function(e,t,r,o){e.$watch("featuredImage",function(t){e.fi.image.url=t})}}}function s(e){return{restrict:"EA",require:"ngModel",scope:{tags:"=ngModel"},replace:!0,controllerAs:"et",controller:["$scope","EditorService",function(e,t){var r=this;r.removingLastTag=!1,r.query=null,r.tags={all:{},posts:{},filtered:{},showSuggestions:!1,suggestions:{}},r.addTag=function(e){for(var t in r.tags.posts)if(r.tags.posts[t].slug==e.slug)return;var o=r.tags.suggestions.indexOf(e);r.tags.suggestions.splice(o,1),r.tags.posts.push(e),r.tags.showSuggestions=!1,r.query=null},r.addToPostTags=function(t){if(t&&0!==t.length){for(var o in r.tags.posts)if(r.tags.posts[o].name==t)return;for(var n in r.tags.suggestions)r.tags.suggestions[n].name==t&&r.tags.suggestions.splice(n,1);r.tags.posts.push({name:t}),r.query=null,r.tags.showSuggestions=!1,e.tags=r.tags.posts}},r.initialize=function(){t.getTags().then(function(e){e.tags&&(r.tags.all=e.tags,r.setSuggestionTags())})},r.removeLastTag=function(){if(!(r.query&&0!==r.query.length||0===r.tags.posts.length)){if(r.removingLastTag){var t=r.tags.posts.length-1;return r.tags.suggestions.push(r.tags.posts[t]),r.tags.posts.splice(t,1),e.tags=r.tags.posts,void(r.removingLastTag=!1)}r.removingLastTag=!0}},r.setSuggestionTags=function(){if(r.tags.suggestions=r.tags.all,r.tags.posts)for(var e in r.tags.posts)for(var t in r.tags.suggestions)r.tags.posts[e].name==r.tags.suggestions[t].name&&r.tags.suggestions.splice(t,1)},r.showTagSuggestions=function(){return r.query&&0!=r.query.length?void(r.tags.showSuggestions=!0):void(r.tags.showSuggestions=!1)},r.initialize()}],templateUrl:e.TEMPLATE_PATH+"editor/_editor-tags.html",link:function(e,t,r,o){e.$watch("tags",function(t){e.et.tags.posts=t});var n=angular.element(t).find("input");n.bind("keyup",function(t){13===t.keyCode&&e.$apply(function(){var t=e.et.query;e.et.addToPostTags(t)}),e.$apply(function(){e.et.showTagSuggestions()})}).bind("keydown",function(t){switch(t.keyCode){case 9:case 13:case 27:t.preventDefault();break;case 8:e.$apply(function(){e.et.removeLastTag()});break;case 40:break;case 38:break;default:e.et.removingLastTag=!1}})}}}angular.module("journal.components.editor").directive("editorScroll",[e]).directive("editorPublishButtons",["CONFIG",t]).directive("inputPostSlug",[r]).directive("editorSidebar",["CONFIG",o]).directive("featuredImage",["CONFIG",n]).directive("editorTags",["CONFIG",s])}(),function(){"use strict";function e(){return{restrict:"A",scope:{publishIndicator:"=publishIndicator"},link:function(e,t,r){var o=Math.floor(Date.now()/1e3);r.publishIndicator&&e.$watch(function(){return e.publishIndicator},function(e){var r=o>=e?"Published":"To be published";t.text(r)})}}}angular.module("journal.components.postLists").directive("publishIndicator",[e])}(),function(){"use strict";function e(){return{restrict:"E",templateUrl:"/assets/templates/sidebar/_sidebar-directive.html",replace:!0,controllerAs:"sd",controller:["$state","AuthService","SidebarService",function(e,t,r){var o=this;o.sidebar={user:t.user(),title:null},o.initialize=function(){r.getBlogSettings().then(function(e){e.settings&&(o.sidebar.title=e.settings.title)},function(e){})},o.logout=function(){t.logout(),e.go("login")},o.initialize()}]}}angular.module("journal.components.sidebar").directive("journalSidebar",[e])}(),function(){"use strict";function e(e){return{restrict:"AE",scope:{journalMarkdown:"=",counter:"="},link:function(t,r,o){var n=function(){var e=0,o=r.text().replace(/^\s\s*/,"").replace(/\s\s*$/,"");o.length>0&&(e=o.match(/[^\s]+/g).length),t.counter=e};if(o.journalMarkdown)t.$watch("journalMarkdown",function(t){var s=t?e.makeHtml(t):"";o.hideScriptIframe&&(s=s.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,'<div class="embedded-javascript">Embedded JavaScript</div>'),s=s.replace(/<iframe\b[^<]*(?:(?!<\/iframe>)<[^<]*)*<\/iframe>/gi,'<div class="embedded-iframe">Embedded iFrame</div>')),r.html(s),n()});else{var s=e.makeHtml(r.text());o.hideScriptIframe&&(s=s.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,'<div class="embedded-javascript">Embedded JavaScript</div>'),s=s.replace(/<iframe\b[^<]*(?:(?!<\/iframe>)<[^<]*)*<\/iframe>/gi,'<div class="embedded-iframe">Embedded iFrame</div>')),r.html(s),n()}}}}angular.module("journal.shared.markdownReader").directive("journalMarkdown",["MarkdownReader",e])}(),function(){"use strict";function e(){var e={};return{config:function(t){e=t},$get:function(){return new showdown.Converter(e)}}}angular.module("journal.shared.markdownReader").provider("MarkdownReader",[e])}(),function(){"use strict";function e(e,t,r,o){this.apiUrl=o.API_URL,this.getPost=function(r){var o=t.defer();return e.get(this.apiUrl+"/posts/get_post?post_id="+r).success(function(e){o.resolve(e)}).error(function(e){o.reject(e)}),o.promise},this.getSlug=function(r,o){var n=t.defer(),s="slug="+(r||"");return o&&(s+="&post_id="+o),e.get(this.apiUrl+"/posts/check_slug?"+s).success(function(e){n.resolve(e)}).error(function(e){n.reject(e)}),n.promise},this.getTags=function(){var r=t.defer();return e.get(this.apiUrl+"/tags/all").success(function(e){r.resolve(e)}).error(function(e){r.reject(e)}),r.promise},this.savePost=function(o){var n=t.defer(),s=r.token(),i=this.apiUrl+"/posts/save?token="+s,a=o.author_id||"",u=o.title||"",l=o.markdown||"",c=o.featured_image||"",g=o.slug||"",p=o.status||2,d=o.tags||[],f=o.published_at.getTime()/1e3||Math.floor(Date.now()/1e3);return o.id&&(i+="&post_id="+o.id),e.post(i,{author_id:a,title:u,markdown:l,featured_image:c,slug:g,status:p,tags:d,published_at:f}).success(function(e){n.resolve(e)}).error(function(e){n.reject(e)}),n.promise}}angular.module("journal.components.editor").service("EditorService",["$http","$q","AuthService","CONFIG",e])}(),function(){"use strict";function e(e,t,r){this.apiUrl=r.API_URL,this.authenticate=function(r,o){var n=t.defer(),s={email:r,password:o};return e.post(this.apiUrl+"/auth/authenticate",s).success(function(e){n.resolve(e)}).error(function(e){n.reject(e)}),n.promise}}angular.module("journal.components.login").service("LoginService",["$http","$q","CONFIG",e])}(),function(){"use strict";function e(e,t,r){this.apiUrl=r.API_URL,this.getAllPosts=function(){var r=t.defer();return e.get(this.apiUrl+"/posts/all").success(function(e){r.resolve(e)}).error(function(e){r.reject(e)}),r.promise}}angular.module("journal.components.postLists").service("PostListsService",["$http","$q","CONFIG",e])}(),function(){"use strict";function e(e,t,r,o){this.apiUrl=o.API_URL,this.getSettings=function(r){var o=t.defer();return e.get(this.apiUrl+"/settings/get?fields="+r).success(function(e){o.resolve(e)}).error(function(e){o.reject(e)}),o.promise},this.saveSettings=function(o){var n=t.defer(),s=r.token(),i={};for(var a in o)i[a]=o[a];return e.post(this.apiUrl+"/settings/save?token="+s,i).success(function(e){n.resolve(e)}).error(function(e){n.reject(e)}),n.promise},this.themes=function(){var r=t.defer();return e.get(this.apiUrl+"/settings/themes").success(function(e){r.resolve(e)}).error(function(e){r.reject(e)}),r.promise}}angular.module("journal.components.settingsGeneral").service("SettingsGeneralService",["$http","$q","AuthService","CONFIG",e])}(),function(){"use strict";function e(e,t,r,o){this.apiUrl=o.API_URL,this.saveSettings=function(o){var n=t.defer(),s=r.token(),i={};for(var a in o)i[a]=o[a];return e.post(this.apiUrl+"/settings/save?token="+s,i).success(function(e){n.resolve(e)}).error(function(e){n.reject(e)}),n.promise}}angular.module("journal.components.settingsGeneralModal").service("SettingsGeneralModalService",["$http","$q","AuthService","CONFIG",e])}(),function(){"use strict";function e(e,t,r){this.apiUrl=r.API_URL,this.getBlogSettings=function(){var r=t.defer(),o="title";return e.get(this.apiUrl+"/settings/get?fields="+o).success(function(e){r.resolve(e)}).error(function(e){r.reject(e)}),r.promise}}angular.module("journal.components.sidebar").service("SidebarService",["$http","$q","CONFIG",e])}(),function(){"use strict";function e(e,t,r,o){this.apiUrl=o.API_URL,this.createUser=function(o){var n=t.defer(),s=r.token();return e.post(this.apiUrl+"/users/create?token="+s,{name:o.name||"",email:o.email||"",password:o.password||"",role:o.role||""}).success(function(e){n.resolve(e)}).error(function(e){n.reject(e)}),n.promise},this.getRoles=function(){var r=t.defer();return e.get(this.apiUrl+"/roles/all").success(function(e){r.resolve(e)}).error(function(e){r.reject(e)}),r.promise}}angular.module("journal.components.userCreate").service("UserCreateService",["$http","$q","AuthService","CONFIG",e])}(),function(){"use strict";function e(e,t,r){this.apiUrl=r.API_URL,this.getUsers=function(){var r=t.defer();return e.get(this.apiUrl+"/users/all").success(function(e){r.resolve(e)}).error(function(e){r.reject(e)}),r.promise}}angular.module("journal.components.userLists").service("UserListsService",["$http","$q","CONFIG",e])}(),function(){"use strict";function e(e,t,r,o){this.apiUrl=o.API_URL,this.getUser=function(r){var o=t.defer();return e.get(this.apiUrl+"/users/get_user?user_id="+r||"").success(function(e){o.resolve(e)}).error(function(e){o.reject(e)}),o.promise},this.updateProfileDetails=function(o){var n=t.defer(),s=r.token(),i=o.id||"";return e.post(this.apiUrl+"/users/update_profile?user_id="+i+"&token="+s,{name:o.name||"",email:o.email||"",biography:o.biography||"",location:o.location||"",website:o.website||"",avatar_url:o.avatar_url||"",cover_url:o.cover_url||""}).success(function(e){n.resolve(e)}).error(function(e){n.reject(e)}),n.promise}}angular.module("journal.components.userProfile").service("UserProfileService",["$http","$q","AuthService","CONFIG",e])}(),function(){"use strict";function e(e,t,r,o){this.apiUrl=o.API_URL,this.updateUserDetails=function(o){var n=t.defer(),s=r.token(),i=o.id||"";return e.post(this.apiUrl+"/users/update_profile?user_id="+i+"&token="+s,{name:o.name||"",email:o.email||"",biography:o.biography||"",location:o.location||"",website:o.website||"",avatar_url:o.avatar_url||"",cover_url:o.cover_url||""}).success(function(e){n.resolve(e)}).error(function(e){n.reject(e)}),n.promise}}angular.module("journal.components.userProfileModal").service("UserProfileModalService",["$http","$q","AuthService","CONFIG",e])}(),function(){"use strict";function e(e,t,r,o){this.apiUrl=o.API_URL,this.login=function(e,t){r.set("user",e),r.set("token",t)},this.logout=function(){r.remove("user"),r.remove("token")},this.token=function(){return r.get("token")},this.user=function(){return r.get("user")},this.validateInstallation=function(){},this.validateToken=function(){var r=t.defer();return e.get(this.apiUrl+"/auth/check?token="+this.token()).success(function(e){r.resolve(e)}).error(function(e){r.reject(e)}),r.promise}}angular.module("journal.shared.auth").service("AuthService",["$http","$q","StorageService","CONFIG",e])}(),function(){"use strict";function e(e,t){this.apiUrl=t.API_URL,this.upload=function(t){return e.upload({url:this.apiUrl+"/upload",file:t})}}angular.module("journal.shared.fileUploader").service("FileUploaderService",["Upload","CONFIG",e])}(),function(){"use strict";function e(e){this.set=function(t,r){return e.set(t,r)},this.get=function(t){return e.get(t)},this.remove=function(t){return e.remove(t)}}angular.module("journal.shared.storage").service("StorageService",["localStorageService",e])}(),function(){"use strict";function e(e){this.toast=function(t,r){switch(r){case"success":e.success(t);break;case"info":e.info(t);break;case"error":e.error(t);break;case"warning":e.warning("message");break;default:e.success(t)}}}angular.module("journal.shared.toastr").service("ToastrService",["toastr",e])}();